<!doctype html>
<html lang="si">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Papers Download3 Hub</title>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6053626510737925"
     crossorigin="anonymous"></script>

  <meta name="google-adsense-account" content="ca-pub-6053626510737925">

  <style>
    :root{
      --sky:#87CEFA; /* sky blue */
      --white:#ffffff;
      --muted:#6b7280;
      --radius:12px;
      font-family: 'Poppins', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg,var(--white) 0%, #f7fbff 100%);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:28px;
    }

    .container{
      max-width:980px;
      margin:0 auto;
      background:var(--white);
      border-radius:16px;
      box-shadow:0 6px 24px rgba(2,6,23,0.08);
      overflow:hidden;
    }

    header{
      display:flex;
      align-items:center;
      gap:16px;
      padding:20px 24px;
      background:linear-gradient(90deg,var(--sky), #e6f6ff);
    }
    header h1{margin:0;font-size:20px;color:#04345f}
    header p{margin:0;color:#04345f;opacity:0.9}

    .main{
      display:grid;
      grid-template-columns:280px 1fr;
      gap:18px;
      padding:20px;
    }

    /* sidebar */
    .sidebar{
      background:#fbfdff;
      border-radius:12px;
      padding:12px;
      height:100%;
    }
    .card{background:linear-gradient(180deg, #fff, #fbfdff); padding:12px; border-radius:10px}

    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    select, input[type=text], input[type=url]{
      width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e6eef7; background:transparent; outline:none
    }

    .subjects{margin-top:12px; display:flex; flex-direction:column; gap:6px}
    .subject-btn{
      border:1px solid transparent; padding:8px 10px; border-radius:8px; cursor:pointer; text-align:left; background:transparent
    }
    .subject-btn.active{background:linear-gradient(90deg,var(--sky), #e6f6ff); color:#012a42}

    /* content list */
    .content{
      padding:4px 0;
    }
    .paper-list{display:grid; gap:10px}
    .paper{
      display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px; border-radius:10px; background:#fff; border:1px solid #eef6ff
    }
    .paper .meta{display:flex; gap:12px; align-items:center}
    .paper .badge{background:var(--sky); color:#04345f; padding:6px 8px; border-radius:8px; font-weight:600}
    .paper .title{font-weight:600}
    .paper .link-btn{padding:8px 12px; border-radius:8px; border:none; cursor:pointer; background:linear-gradient(90deg,#0284c7,#0369a1); color:white}

    /* add form */
    .add-form{margin-top:14px; display:grid; gap:8px}
    .row{display:flex; gap:8px}
    .row > *{flex:1}

    .small{font-size:12px;color:var(--muted)}

    footer{padding:12px 20px; text-align:center; font-size:13px; color:var(--muted)}

    /* responsive */
    @media (max-width:860px){
      .main{grid-template-columns:1fr;}
      header{flex-direction:column; align-items:flex-start}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Papers Download Hub</h1>
        <p class="small">Grade-wise past papers — open with Google Drive links</p>
      </div>
    </header>

    <div class="main">
      <aside class="sidebar card">
        <div>
          <label for="gradeSelect">Grade</label>
          <select id="gradeSelect">
            <option value="">-- Select Grade --</option>
            <!-- grades 1-13 example -->
            <script>for(let g=1;g<=13;g++){document.write(`<option value="${g}">Grade ${g}</option>`)};</script>
          </select>
        </div>

        <div style="margin-top:12px">
          <label>Subjects</label>
          <div id="subjects" class="subjects">
            <!-- dynamic subjects buttons -->
          </div>
        </div>

        <div style="margin-top:16px">
          <label>Search papers</label>
          <input id="searchInput" placeholder="Search by paper name" />
        </div>

        <div class="small" style="margin-top:14px">Admin: Add paper</div>
        <div class="add-form">
          <input id="addName" type="text" placeholder="Paper name (e.g., Maths 2019)" />
          <input id="addSubject" type="text" placeholder="Subject (e.g., Maths)" />
          <input id="addLink" type="url" placeholder="Google Drive link (shareable)" />
          <div class="row">
            <input id="addGrade" type="text" placeholder="Grade" />
            <button id="addBtn" class="link-btn">Add Paper</button>
          </div>
          <div class="small">Note: Keep Drive link as a shareable link (Anyone with the link can view).</div>
        </div>
      </aside>

      <section class="content">
        <!-- optional adsense placeholder -->
        <div style="padding:8px 0;">
          <!-- AdSense: replace data-ad-client in head with your client id to enable -->
          <div style="border-radius:8px; padding:12px; background:linear-gradient(90deg, #fff, #f7fdff); text-align:center; color:var(--muted)">Ad space (configure AdSense client id to show ads)</div>
        </div>

        <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; padding:6px 2px;">
          <div>
            <label class="small">Showing papers</label>
            <div id="currentInfo" style="font-weight:600; margin-top:4px">Select a grade to see subjects & papers</div>
          </div>
          <div>
            <label class="small">Sort</label>
            <select id="sortSelect">
              <option value="new">Newest</option>
              <option value="name">Name A→Z</option>
            </select>
          </div>
        </div>

        <div class="paper-list" id="paperList"></div>
      </section>
    </div>

    <footer>Made with ❤️ — Replace AdSense client id to connect ads. Deploy to Firebase Hosting for best results.</footer>
  </div>

  <!-- Firebase v9 modular (ES modules) -->
  <script type="module">
    // Import Firebase modules from the CDN
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
    import { getFirestore, collection, addDoc, query, where, orderBy, onSnapshot, getDocs, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';

    // <- REPLACE WITH YOUR FIREBASE CONFIG BELOW (already provided) ->
    const firebaseConfig = {
      apiKey: "AIzaSyCfRjYCF7k6bV3Pp9BHXm86yEVkkll4rzQ",
      authDomain: "helix-ofc-7d382.firebaseapp.com",
      projectId: "helix-ofc-7d382",
      storageBucket: "helix-ofc-7d382.appspot.com",
      messagingSenderId: "443626880782",
      appId: "1:443626880782:web:0a697b0fb7eafe4910615f"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const papersCol = collection(db, 'papers');

    // UI references
    const gradeSelect = document.getElementById('gradeSelect');
    const subjectsDiv = document.getElementById('subjects');
    const paperList = document.getElementById('paperList');
    const currentInfo = document.getElementById('currentInfo');
    const searchInput = document.getElementById('searchInput');
    const sortSelect = document.getElementById('sortSelect');

    const addBtn = document.getElementById('addBtn');
    const addName = document.getElementById('addName');
    const addSubject = document.getElementById('addSubject');
    const addLink = document.getElementById('addLink');
    const addGrade = document.getElementById('addGrade');

    // local state
    let allPapers = [];
    let selectedGrade = '';
    let selectedSubject = '';

    // helper: render subjects from papers for chosen grade
    function renderSubjects(){
      subjectsDiv.innerHTML = '';
      if(!selectedGrade){ subjectsDiv.innerHTML = '<div class="small">Select a grade first</div>'; return; }
      const subs = [...new Set(allPapers.filter(p=>p.grade==selectedGrade).map(p=>p.subject))].sort();
      if(subs.length===0){ subjectsDiv.innerHTML = '<div class="small">No subjects found for this grade</div>'; return; }
      subs.forEach(s=>{
        const b=document.createElement('button');
        b.textContent=s;
        b.className='subject-btn'+(s===selectedSubject?' active':'');
        b.onclick=()=>{ selectedSubject = s===selectedSubject? '': s; renderSubjects(); renderPapers(); }
        subjectsDiv.appendChild(b);
      })
    }

    // render paper list
    function renderPapers(){
      paperList.innerHTML='';
      if(!selectedGrade){ currentInfo.textContent='Select a grade to see subjects & papers'; return; }
      currentInfo.textContent = `Grade ${selectedGrade}` + (selectedSubject? ` — ${selectedSubject}` : '');
      const q = searchInput.value.trim().toLowerCase();
      let papers = allPapers.filter(p=>p.grade==selectedGrade);
      if(selectedSubject) papers = papers.filter(p=>p.subject==selectedSubject);
      if(q) papers = papers.filter(p=>p.name.toLowerCase().includes(q));

      if(sortSelect.value==='name') papers.sort((a,b)=> a.name.localeCompare(b.name));
      else papers.sort((a,b)=> b.createdAt - a.createdAt);

      if(papers.length===0) { paperList.innerHTML = '<div class="small">No papers found</div>'; return; }

      papers.forEach(p=>{
        const el=document.createElement('div'); el.className='paper';
        const meta=document.createElement('div'); meta.className='meta';
        const badge=document.createElement('div'); badge.className='badge'; badge.textContent = p.subject || '—';
        const name=document.createElement('div'); name.innerHTML = `<div class="title">${p.name}</div><div class="small">Grade ${p.grade} • added: ${new Date(p.createdAt).toLocaleDateString()}</div>`;
        meta.appendChild(badge); meta.appendChild(name);
        const actions=document.createElement('div');
        const open=document.createElement('button'); open.className='link-btn'; open.textContent='Open'; open.onclick=()=> window.open(p.driveLink,'_blank');
        actions.appendChild(open);
        el.appendChild(meta); el.appendChild(actions);
        paperList.appendChild(el);
      })
    }

    // load papers once and listen for changes
    async function loadPapers(){
      try{
        // onSnapshot would give real-time updates, but we'll fetch once and set up a periodic refresh
        const snapshot = await getDocs(papersCol);
        allPapers = snapshot.docs.map(d=>({id:d.id, ...d.data()}));
        // normalize createdAt timestamps
        allPapers = allPapers.map(p=>({ ...p, createdAt: p.createdAt && p.createdAt.seconds ? p.createdAt.seconds*1000 : (p.createdAt || Date.now()) }));
        renderSubjects(); renderPapers();
      }catch(e){ console.error('load error',e); }
    }

    // add paper (admin)
    addBtn.addEventListener('click', async ()=>{
      const name = addName.value.trim();
      const subject = addSubject.value.trim();
      const driveLink = addLink.value.trim();
      const grade = addGrade.value.trim();
      if(!name||!subject||!driveLink||!grade){ alert('Fill all fields'); return; }
      try{
        await addDoc(papersCol, { name, subject, driveLink, grade: grade.toString(), createdAt: serverTimestamp() });
        addName.value=''; addSubject.value=''; addLink.value=''; addGrade.value='';
        alert('Paper added');
        loadPapers();
      }catch(e){ console.error(e); alert('Error adding paper'); }
    });

    // UI events
    gradeSelect.addEventListener('change', ()=>{ selectedGrade = gradeSelect.value; selectedSubject=''; renderSubjects(); renderPapers(); });
    searchInput.addEventListener('input', ()=> renderPapers());
    sortSelect.addEventListener('change', ()=> renderPapers());

    // initial load
    loadPapers();

    // Optional: realtime listener (uncomment if you prefer real-time updates)
    /*
    import { onSnapshot } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';
    onSnapshot(papersCol, (snap)=>{
      allPapers = snap.docs.map(d=>({id:d.id, ...d.data()})).map(p=>({ ...p, createdAt: p.createdAt && p.createdAt.seconds ? p.createdAt.seconds*1000 : (p.createdAt || Date.now()) }));
      renderSubjects(); renderPapers();
    });
    */

  </script>

  <!-- Notes & deployment
       - Replace the AdSense data-ad-client in the head with your publisher id to enable ads.
       - To deploy: use Firebase Hosting (firebase init hosting) and upload this file as index.html.
       - Ensure Firestore rules allow reads for your users or set authentication for admin adds.
  -->
</body>

</html>


